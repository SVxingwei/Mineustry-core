# 核心方块模组 - 详细功能说明

## 核心特性详解

### 1. 世界级共享存储

**工作原理：**
- 存储数据保存在世界的`SavedData`中，而不是方块的NBT数据
- 所有具有相同核心ID的核心方块共享同一个存储空间
- 即使破坏核心方块，存储的物品仍然保留在世界数据中
- 重新放置相同ID的核心可以访问之前的存储

**存储容量：**
- 基础容量：每个核心实例 = 8000个物品槽位
- 动态扩展：放置更多相同ID的核心会增加总容量
- 计算公式：总容量 = 核心数量 × 8000

**示例：**
```
玩家A放置3个核心（ID="主存储"）：
总容量 = 3 × 8000 = 24,000个物品

玩家B也放置2个核心（ID="主存储"）：
如果是公共核心，总容量 = 5 × 8000 = 40,000个物品
如果是私有核心，A和B各自独立计算
```

### 2. 公共与私有核心

**公共核心（Public Core）：**
- 所有玩家的相同ID核心共享同一存储
- 适合服务器团队协作
- 可设置是否允许其他玩家访问

**私有核心（Private Core）：**
- 只有同一玩家的相同ID核心共享存储
- 存储ID格式：`核心ID_玩家UUID`
- 其他玩家无法访问，即使使用相同的核心ID

### 3. 溢出物品处理

当移除核心导致容量减少时：

**烧毁模式（Burn Overflow = true）：**
- 超出新容量的物品将被永久删除
- 从存储列表的开始处删除，直到达到新容量

**保留模式（Burn Overflow = false）：**
- 物品保留在存储中，即使超出容量
- 无法插入新物品，直到容量恢复

### 4. 能量生成系统

**规格：**
- 发电量：100 FE/tick（2000 FE/秒）
- 内部缓存：1,000,000 FE
- 输出接口：Forge能量系统（IEnergyStorage）

**用途：**
- 可以连接到能量管道（如Mekanism、EnderIO等）
- 为附近的机器供电
- 作为可靠的基础能量来源

### 5. GUI系统

**合成模式：**
```
┌─────────────────────────────┐
│  [合成网格]    [结果]  [浏览]│
│  ┌─┬─┬─┐      ┌─┐          │
│  │ │ │ │  →   │ │          │
│  ├─┼─┼─┤      └─┘          │
│  │ │ │ │                   │
│  ├─┼─┼─┤                   │
│  │ │ │ │                   │
│  └─┴─┴─┘                   │
│                             │
│  [玩家背包]                 │
│  容量: 16000/24000          │
└─────────────────────────────┘
```

**浏览模式：**
```
┌─────────────────────────────┐
│  [物品网格 6×3]    [滚动条] │
│  ┌─┬─┬─┬─┬─┬─┐    │        │
│  │ │ │ │ │ │ │    │        │
│  ├─┼─┼─┼─┼─┼─┤    ▓        │
│  │ │ │ │ │ │ │    │        │
│  ├─┼─┼─┼─┼─┼─┤    │        │
│  │ │ │ │ │ │ │    │        │
│  └─┴─┴─┴─┴─┴─┘    │        │
│                             │
│  [玩家背包]                 │
│  容量: 16000/24000          │
└─────────────────────────────┘
```

### 6. 配置选项

**核心ID（Core ID）：**
- 默认值："default"
- 用途：标识不同的存储系统
- 相同ID的核心共享存储

**公共核心（Is Public）：**
- true：多人共享
- false：仅限个人

**允许其他玩家（Allow Others）：**
- true：其他玩家可以打开GUI
- false：只有拥有者可以访问

**烧毁溢出物品（Burn Overflow）：**
- true：超出容量的物品被删除
- false：超出容量的物品保留

## 使用场景

### 场景1：个人基地存储
```
设置：
- 核心ID: "my_storage"
- 公共核心: false
- 允许其他玩家: false
- 烧毁溢出: true

放置3个核心 = 24,000容量
只有你可以访问
```

### 场景2：团队协作
```
设置：
- 核心ID: "team_storage"
- 公共核心: true
- 允许其他玩家: true
- 烧毁溢出: false

所有团队成员共享存储
每个成员放置的核心增加总容量
```

### 场景3：专用分类存储
```
核心A：
- ID: "ores"
- 存储所有矿物

核心B：
- ID: "food"
- 存储所有食物

核心C：
- ID: "tools"
- 存储所有工具
```

## AE2/RS集成（计划中）

### 与应用能源2的集成

**功能：**
- 核心可作为AE2网络的存储驱动器
- 在ME终端中查看核心存储的物品
- 使用ME合成终端访问核心合成功能
- 自动化物品存取

**实现状态：**
- 框架代码已准备
- 需要添加AE2 API依赖
- 需要实现IGridNode和IStorageProvider接口

### 与精致存储的集成

**功能：**
- 核心可连接到RS网络
- 在RS网格中显示核心物品
- 使用RS合成网格访问核心
- 自动化输入输出

**实现状态：**
- 框架代码已准备
- 需要添加RS API依赖
- 需要实现INetworkNode接口

## 性能考虑

**存储优化：**
- 使用HashMap存储物品，O(1)查找时间
- 只在需要时同步数据到客户端
- NBT数据压缩存储

**网络优化：**
- 按需加载存储数据
- 增量更新而非完整同步
- 批量操作减少网络包

**内存优化：**
- 物品堆叠合并
- 延迟加载物品列表
- 自动清理空堆叠
